Por supuesto, aquí están las funciones de la API de Windows en C que se usarían para cada uno de los pasos en las técnicas que mencionaste:

1. **Make and Impersonate Token**¹²³⁴:
    - **Crear un token**: Si un adversario tiene un nombre de usuario y una contraseña pero el usuario no está conectado al sistema, el adversario puede crear una sesión de inicio de sesión para el usuario usando la función `LogonUser`¹.
    - **Duplicar el token creado**: La función devolverá una copia del token de acceso de la nueva sesión y el adversario puede usar `SetThreadToken` para asignar el token a un hilo¹.
    - **Impersonar el token duplicado**: Este comportamiento es distinto de Token Impersonation/Theft en que se refiere a la creación de un nuevo token de usuario en lugar de robar o duplicar uno existente¹.

2. **Create Process with Token**⁶⁷⁸:
    - **Obtener un token de acceso**: Un adversario puede obtener un token de acceso que representa a un usuario llamando a la función `LogonUser`⁶.
    - **Duplicar el token obtenido**: Alternativamente, puede llamar a la función `DuplicateTokenEx` para convertir un token de suplantación en un token principal⁶.
    - **Crear un nuevo proceso con el token duplicado**: Los procesos pueden crearse con el token y el contexto de seguridad resultante de otro usuario utilizando características como `CreateProcessWithTokenW`⁶.
   



INSTRUCCIONES DEL CreateProcessWithToken.exe
 - no hace falta ejecutarlo como administrador (importante, tokenimpersation.exe si)